{{- if .Values.clusterAutoscaler.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "chart.name" . }}-cluster-autoscaler-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "chart.labels" . | nindent 4 }}
    app.kubernetes.io/component: cluster-autoscaler
data:
  config.yaml: |
    # External gRPC cloud provider configuration
    # Required format for cluster autoscaler external gRPC provider
    address: {{ .Values.clusterAutoscaler.grpcProvider.endpoint | default (printf "%s-grpc-service:50051" (include "chart.name" .)) }}
    grpc_timeout: 30s
{{- end }}